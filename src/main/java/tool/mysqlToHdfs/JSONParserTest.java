package tool.mysqlToHdfs;

import cn.hutool.json.JSONUtil;

import java.util.List;
import java.util.Map;

/**
 * @author pengzhong
 * @since 2023/6/27
 */
public class JSONParserTest {

    public static void main(String[] args) {
        String json = "[{\"id\":222,\"code\":10039153938528,\"name\":\"创建分区,清理分区\",\"version\":2,\"description\":\"\",\"projectCode\":9562937624544,\"userId\":1,\"taskType\":\"SQL\",\"taskParams\":{\"localParams\":[],\"resourceList\":[],\"type\":\"HIVE\",\"datasource\":1,\"sql\":\"truncate table channel_talent\",\"sqlType\":\"1\",\"preStatements\":[],\"postStatements\":[],\"segmentSeparator\":\"\",\"displayRows\":10,\"udfs\":\"\"},\"taskParamList\":[],\"taskParamMap\":null,\"flag\":\"YES\",\"taskPriority\":\"MEDIUM\",\"userName\":null,\"projectName\":null,\"workerGroup\":\"default\",\"environmentCode\":9562963824992,\"failRetryTimes\":0,\"failRetryInterval\":1,\"timeoutFlag\":\"CLOSE\",\"timeoutNotifyStrategy\":\"WARN\",\"timeout\":0,\"delayTime\":0,\"resourceIds\":\"\",\"createTime\":\"2023-06-27 18:21:50\",\"updateTime\":\"2023-06-27 18:32:23\",\"modifyBy\":null,\"taskGroupId\":0,\"taskGroupPriority\":0,\"cpuQuota\":-1,\"memoryMax\":-1,\"taskExecuteType\":\"BATCH\",\"operator\":1,\"operateTime\":\"2023-06-27 18:32:23\",\"dependence\":\"\"},{\"id\":223,\"code\":10039153938529,\"name\":\"channel_talent同步到hive\",\"version\":3,\"description\":\"\",\"projectCode\":9562937624544,\"userId\":1,\"taskType\":\"DATAX\",\"taskParams\":{\"localParams\":[],\"resourceList\":[],\"customConfig\":1,\"json\":\"{\\n  \\\"job\\\": {\\n    \\\"setting\\\": {\\n      \\\"speed\\\": {\\n        \\\"channel\\\": 3,\\n        \\\"byte\\\": 1048576\\n      },\\n      \\\"errorLimit\\\": {\\n        \\\"record\\\": 0,\\n        \\\"percentage\\\": 0.02\\n      }\\n    },\\n    \\\"content\\\": [\\n      {\\n        \\\"reader\\\": {\\n          \\\"name\\\": \\\"mysqlreader\\\",\\n          \\\"parameter\\\": {\\n            \\\"username\\\": \\\"root\\\",\\n            \\\"password\\\": \\\"Reducom888%\\\",\\n            \\\"splitPk\\\": \\\"id\\\",\\n            \\\"connection\\\": [\\n              {\\n                \\\"jdbcUrl\\\": [\\n                  \\\"jdbc:mysql://192.168.33.28:3306/xingxuan??serverTimezone=Asia/Shanghai&useSSL=false\\\"\\n                ],\\n                \\\"querySql\\\": [\\n                  \\\"SELECT id,team_id,branch_id,group_id,channel_id,platform,home_url,unique_id,account_id,douyinuid,open_finder_id,nickname,nickname_pinyin_head,nickname_pinyin_all,fans_total,avatar,shop_sales,level,last_update_level_at,weixinid,post_name,post_telephone,post_address,external_telephone,remark,audit_status,audit_failed_reason,audited_at,status,is_vip,out_count,talent_type,is_competition,is_locked,lock_expired_at,is_delete,deleted_at,last_update_address_at,assign_time,ex_channel_id,freed_at,freed_way,freed_times,rebind_at,created_at,updated_at,last_update_sales_at,last_matrix_audit_at,is_duty,duty_team_id,now_all_gmv,now_redu_gmv,now_permeability,prev_permeability,post_area,window_capture,team_talent_type,bind_duty_at,is_can_repeat,is_live_streaming,is_vertical_account FROM channel_talent\\\"\\n                ]\\n              }\\n            ]\\n          }\\n        },\\n        \\\"writer\\\": {\\n          \\\"name\\\": \\\"hdfswriter\\\",\\n          \\\"parameter\\\": {\\n            \\\"defaultFS\\\": \\\"hdfs://192.168.33.22:9000\\\",\\n            \\\"fileType\\\": \\\"orc\\\",\\n            \\\"path\\\": \\\"/user/hive/warehouse/data_cube.db/channel_talent\\\",\\n            \\\"fileName\\\": \\\"channel_talent\\\",\\n            \\\"writeMode\\\": \\\"append\\\",\\n            \\\"fieldDelimiter\\\": \\\",\\\",\\n            \\\"column\\\": [{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"id\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"team_id\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"branch_id\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"group_id\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"channel_id\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"platform\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"home_url\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"unique_id\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"account_id\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"douyinuid\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"open_finder_id\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"nickname\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"nickname_pinyin_head\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"nickname_pinyin_all\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"fans_total\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"avatar\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"shop_sales\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"level\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"last_update_level_at\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"weixinid\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"post_name\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"post_telephone\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"post_address\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"external_telephone\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"remark\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"audit_status\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"audit_failed_reason\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"audited_at\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"status\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_vip\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"out_count\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"talent_type\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_competition\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_locked\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"lock_expired_at\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_delete\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"deleted_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"last_update_address_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"assign_time\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"ex_channel_id\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"freed_at\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"freed_way\\\"},{\\\"type\\\":\\\"tinyint\\\",\\\"name\\\":\\\"freed_times\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"rebind_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"created_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"updated_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"last_update_sales_at\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"last_matrix_audit_at\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_duty\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"duty_team_id\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"now_all_gmv\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"now_redu_gmv\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"now_permeability\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"prev_permeability\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"post_area\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"window_capture\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"team_talent_type\\\"},{\\\"type\\\":\\\"int\\\",\\\"name\\\":\\\"bind_duty_at\\\"},{\\\"type\\\":\\\"tinyint\\\",\\\"name\\\":\\\"is_can_repeat\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_live_streaming\\\"},{\\\"type\\\":\\\"smallint\\\",\\\"name\\\":\\\"is_vertical_account\\\"}]\\n          }\\n        }\\n      }\\n    ]\\n  }\\n}\",\"xms\":1,\"xmx\":1},\"taskParamList\":[],\"taskParamMap\":null,\"flag\":\"YES\",\"taskPriority\":\"MEDIUM\",\"userName\":null,\"projectName\":null,\"workerGroup\":\"default\",\"environmentCode\":9562963824992,\"failRetryTimes\":0,\"failRetryInterval\":1,\"timeoutFlag\":\"CLOSE\",\"timeoutNotifyStrategy\":\"WARN\",\"timeout\":0,\"delayTime\":0,\"resourceIds\":\"\",\"createTime\":\"2023-06-27 18:21:50\",\"updateTime\":\"2023-06-27 18:32:23\",\"modifyBy\":null,\"taskGroupId\":0,\"taskGroupPriority\":0,\"cpuQuota\":-1,\"memoryMax\":-1,\"taskExecuteType\":\"BATCH\",\"operator\":1,\"operateTime\":\"2023-06-27 18:32:23\",\"dependence\":\"\"},{\"code\":10039320765664,\"delayTime\":\"0\",\"description\":\"\",\"environmentCode\":9562963824992,\"failRetryInterval\":\"1\",\"failRetryTimes\":\"0\",\"flag\":\"YES\",\"name\":\"member_talent同步到hive_rn\",\"taskGroupId\":null,\"taskGroupPriority\":null,\"taskParams\":{\"localParams\":[],\"resourceList\":[],\"customConfig\":1,\"json\":\"{\\n  \\\"job\\\": {\\n    \\\"setting\\\": {\\n      \\\"speed\\\": {\\n        \\\"channel\\\": 3,\\n        \\\"byte\\\": 1048576\\n      },\\n      \\\"errorLimit\\\": {\\n        \\\"record\\\": 0,\\n        \\\"percentage\\\": 0.02\\n      }\\n    },\\n    \\\"content\\\": [\\n      {\\n        \\\"reader\\\": {\\n          \\\"name\\\": \\\"mysqlreader\\\",\\n          \\\"parameter\\\": {\\n            \\\"username\\\": \\\"root\\\",\\n            \\\"password\\\": \\\"Reducom888%\\\",\\n            \\\"splitPk\\\": \\\"id\\\",\\n            \\\"connection\\\": [\\n              {\\n                \\\"jdbcUrl\\\": [\\n                  \\\"jdbc:mysql://192.168.33.28:3306/xingxuan??serverTimezone=Asia/Shanghai&useSSL=false\\\"\\n                ],\\n                \\\"querySql\\\": [\\n                  \\\"SELECT id,team_id,channel_id,duty_channel_id,is_duty,member_id,platform,unique_id,union_id,local_identifier,nickname,nickname_pinyin_head,nickname_pinyin_all,fans_total,avatar,mobile,city,province,country,gender,shop_sales,last_month_sales,level,last_update_level_at,sales_level,sales_score,sales_text,uid,remark,account_role,audit_status,audit_failed_reason,audited_at,status,failure_type,failure_at,is_delete,delete_at,delete_member_id,is_freed,freed_at,rebind_at,ex_channel_id,freed_way,access_token,freed_times,expires_in,refresh_token,refresh_expires_in,created_at,updated_at,order_num,sync_douyin_order,last_sync_at,last_update_at,is_distribute,signature,account_id,short_id,allow_fetch,allow_fetch_modify,average_price,last_time,bind_duty_at,is_live_streaming,is_vertical_account FROM member_talent\\\"\\n                ]\\n              }\\n            ]\\n          }\\n        },\\n        \\\"writer\\\": {\\n          \\\"name\\\": \\\"hdfswriter\\\",\\n          \\\"parameter\\\": {\\n            \\\"defaultFS\\\": \\\"hdfs://192.168.33.22:9000\\\",\\n            \\\"fileType\\\": \\\"orc\\\",\\n            \\\"path\\\": \\\"/user/hive/warehouse/data_cube.db/member_talent\\\",\\n            \\\"fileName\\\": \\\"member_talent\\\",\\n            \\\"writeMode\\\": \\\"append\\\",\\n            \\\"fieldDelimiter\\\": \\\",\\\",\\n            \\\"column\\\": [{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"id\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"team_id\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"channel_id\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"duty_channel_id\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_duty\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"member_id\\\"},{\\\"type\\\":\\\"varchar(16)\\\",\\\"name\\\":\\\"platform\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"unique_id\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"union_id\\\"},{\\\"type\\\":\\\"varchar(15)\\\",\\\"name\\\":\\\"local_identifier\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"nickname\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"nickname_pinyin_head\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"nickname_pinyin_all\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"fans_total\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"avatar\\\"},{\\\"type\\\":\\\"varchar(14)\\\",\\\"name\\\":\\\"mobile\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"city\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"province\\\"},{\\\"type\\\":\\\"varchar(32)\\\",\\\"name\\\":\\\"country\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"gender\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"shop_sales\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"last_month_sales\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"level\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"last_update_level_at\\\"},{\\\"type\\\":\\\"varchar(32)\\\",\\\"name\\\":\\\"sales_level\\\"},{\\\"type\\\":\\\"varchar(32)\\\",\\\"name\\\":\\\"sales_score\\\"},{\\\"type\\\":\\\"varchar(512)\\\",\\\"name\\\":\\\"sales_text\\\"},{\\\"type\\\":\\\"varchar(32)\\\",\\\"name\\\":\\\"uid\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"remark\\\"},{\\\"type\\\":\\\"varchar(32)\\\",\\\"name\\\":\\\"account_role\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"audit_status\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"audit_failed_reason\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"audited_at\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"status\\\"},{\\\"type\\\":\\\"smallint(2)\\\",\\\"name\\\":\\\"failure_type\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"failure_at\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_delete\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"delete_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"delete_member_id\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_freed\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"freed_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"rebind_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"ex_channel_id\\\"},{\\\"type\\\":\\\"varchar(255)\\\",\\\"name\\\":\\\"freed_way\\\"},{\\\"type\\\":\\\"varchar(256)\\\",\\\"name\\\":\\\"access_token\\\"},{\\\"type\\\":\\\"tinyint(6)\\\",\\\"name\\\":\\\"freed_times\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"expires_in\\\"},{\\\"type\\\":\\\"varchar(512)\\\",\\\"name\\\":\\\"refresh_token\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"refresh_expires_in\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"created_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"updated_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"order_num\\\"},{\\\"type\\\":\\\"tinyint(3)\\\",\\\"name\\\":\\\"sync_douyin_order\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"last_sync_at\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"last_update_at\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_distribute\\\"},{\\\"type\\\":\\\"varchar(2048)\\\",\\\"name\\\":\\\"signature\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"account_id\\\"},{\\\"type\\\":\\\"varchar(64)\\\",\\\"name\\\":\\\"short_id\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"allow_fetch\\\"},{\\\"type\\\":\\\"int(10)\\\",\\\"name\\\":\\\"allow_fetch_modify\\\"},{\\\"type\\\":\\\"string\\\",\\\"name\\\":\\\"average_price\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"last_time\\\"},{\\\"type\\\":\\\"int(11)\\\",\\\"name\\\":\\\"bind_duty_at\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_live_streaming\\\"},{\\\"type\\\":\\\"smallint(6)\\\",\\\"name\\\":\\\"is_vertical_account\\\"}]}\\n        }\\n      }\\n    ]\\n  }\\n}\",\"xms\":1,\"xmx\":1},\"taskPriority\":\"MEDIUM\",\"taskType\":\"DATAX\",\"timeout\":0,\"timeoutFlag\":\"CLOSE\",\"timeoutNotifyStrategy\":\"\",\"workerGroup\":\"default\",\"cpuQuota\":-1,\"memoryMax\":-1,\"taskExecuteType\":\"BATCH\",\"version\":3,\"id\":223}]";
        List<Object> list = JSONUtil.toList(json, Object.class);
        System.out.println(JSONUtil.toJsonStr(list));
    }

}
